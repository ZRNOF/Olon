const t=new Set([35680,35678,35679,35682,36289,36292,36293]),e={i8:{size:1,type:5120},i16:{size:2,type:5122},i32:{size:4,type:5124},u8:{size:1,type:5121},u16:{size:2,type:5123},u32:{size:4,type:5125},f32:{size:4,type:5126}},r={Int8Array:"i8",Int16Array:"i16",Int32Array:"i32",Uint8Array:"u8",Uint16Array:"u16",Uint32Array:"u32",Float32Array:"f32"},i={i8:Int8Array,i16:Int16Array,i32:Int32Array,u8:Uint8Array,u16:Uint16Array,u32:Uint32Array,f32:Float32Array},o={6407:{format:6407,type:5121},6408:{format:6408,type:5121},6410:{format:6410,type:5121},6409:{format:6409,type:5121},6406:{format:6406,type:5121},33321:{format:6403,type:5121},33325:{format:6403,type:5126},33326:{format:6403,type:5126},33330:{format:36244,type:5121},33323:{format:33319,type:5121},33327:{format:33319,type:5126},33328:{format:33319,type:5126},33336:{format:33320,type:5121},32849:{format:6407,type:5121},35905:{format:6407,type:5121},36194:{format:6407,type:5121},35898:{format:6407,type:5126},35901:{format:6407,type:5126},34843:{format:6407,type:5126},34837:{format:6407,type:5126},36221:{format:36248,type:5121},32856:{format:6408,type:5121},35907:{format:6408,type:5121},32855:{format:6408,type:5121},32857:{format:6408,type:33640},32854:{format:6408,type:5121},34842:{format:6408,type:5126},34836:{format:6408,type:5126},36220:{format:36249,type:5121}};var s=(t,e="f32")=>{if(Array.isArray(t))return new i[e](t.flat(1/0));if("number"==typeof t)return new i[e](t);throw new Error("Unsupported data type")};var n=class{constructor(t=300,r=150){var i;this.frame=0,this.seconds=0,this.startTime=0,this.currentTime=performance.now(),this.lastFrameTime=performance.now(),this.fps=60,this.oMouseX=0,this.oMouseY=0,this.mouseX=0,this.mouseY=0,this.bufferList={},this.canvas2D=null,this.o2D=null,this.canvas=document.createElement("canvas"),[this.canvas.width,this.canvas.height]=[t,r],this.canvas.id="olon-canvas",document.body.appendChild(this.canvas),this.gl=this.canvas.getContext("webgl2"),this.program=null,this.canvas.addEventListener("mousemove",(t=>this._mouseMove(t,this.canvas))),this.canvas.addEventListener("touchmove",(t=>this._touchMove(t,this.canvas))),this.UnitMap=e,this.IFormatMap=o,this.UniformMap=(i=this.gl,{5126:(t,e)=>i.uniform1f(t,e),35664:(t,e)=>i.uniform2fv(t,e),35665:(t,e)=>i.uniform3fv(t,e),35666:(t,e)=>i.uniform4fv(t,e),5124:(t,e)=>i.uniform1i(t,e),35667:(t,e)=>i.uniform2iv(t,e),35668:(t,e)=>i.uniform3iv(t,e),35669:(t,e)=>i.uniform4iv(t,e),35670:(t,e)=>i.uniform1i(t,e),35671:(t,e)=>i.uniform2iv(t,e),35672:(t,e)=>i.uniform3iv(t,e),35673:(t,e)=>i.uniform4iv(t,e),35674:(t,e)=>i.uniformMatrix2fv(t,!1,e),35675:(t,e)=>i.uniformMatrix3fv(t,!1,e),35676:(t,e)=>i.uniformMatrix4fv(t,!1,e),5125:(t,e)=>i.uniform1u(t,e),36294:(t,e)=>i.uniform2uv(t,e),36295:(t,e)=>i.uniform3uv(t,e),36296:(t,e)=>i.uniform4uv(t,e),35678:(t,e)=>i.uniform1i(t,e),35679:(t,e)=>i.uniform1i(t,e),35682:(t,e)=>i.uniform1i(t,e),36289:(t,e)=>i.uniform1i(t,e),36292:(t,e)=>i.uniform1i(t,e),36293:(t,e)=>i.uniform1i(t,e)})}sketchData(){return{positionData:s([-1,-1,1,-1,1,1,1,1,-1,1,-1,-1]),texCoordData:s([0,0,1,0,1,1,1,1,0,1,0,0])}}quadData(){return s([[-1,-1,0,0],[1,-1,1,0],[1,1,1,1],[1,1,1,1],[-1,1,0,1],[-1,-1,0,0]])}sketch(){const{positionData:t,texCoordData:e}=this.sketchData();this.setAttribute("aPosition",t,"f32",2),this.setAttribute("aTexCoord",e,"f32",2)}fullscreen(){const{left:t,top:e}=this._getBorderSize(this.canvas);this.width=window.innerWidth-2*t,this.height=window.innerHeight-2*e,window.addEventListener("resize",(()=>{const{left:t,top:e}=this._getBorderSize(this.canvas);this.width=window.innerWidth-2*t,this.height=window.innerHeight-2*e}))}enableCanvas2D(t="#000000"){this.canvas2D=document.createElement("canvas"),[this.canvas2D.width,this.canvas2D.height]=[this.canvas.width,this.canvas.height],this.canvas2D.id="o2d",document.body.appendChild(this.canvas2D),this.o2D=this.canvas2D.getContext("2d"),this.o2D.fillStyle=t,this.o2D.fillRect(0,0,this.canvas2D.width,this.canvas2D.height),this.canvas.style.display="none",this.canvas2D.addEventListener("mousemove",(t=>this._mouseMove(t,this.canvas2D))),this.canvas2D.addEventListener("touchmove",(t=>this._touchMove(t,this.canvas2D)))}render(t){const e=r=>{this.frame++,this.timestamp=r,this.currentTime=performance.now(),this.seconds=(this.currentTime-this.startTime)/1e3,this.fps=1e3/(this.currentTime-this.lastFrameTime),t(),this.canvas2D&&this.o2D.drawImage(this.canvas,0,0),this.lastFrameTime=this.currentTime,requestAnimationFrame(e)};this.startTime=performance.now(),requestAnimationFrame(e)}use({program:t=null,VAO:e=null,FBO:r=null,RBO:i=null,texture2D:o=null,buffer:s=null,Depth:n=!1,Blend:a=!1}={program:t,VAO:e,FBO:r,RBO:i,texture2D:o,Depth:n,Blend:a}){return{run:h=>{t&&this.useProgram(t),e&&this.bindVAO(e),r&&this.bindFBO(r),i&&this.bindRBO(i),o&&this.bindTexture2D(o),s&&this.bindBuffer(s),n&&this.enableDepth(),a&&this.enableBlend(),h(),a&&this.disableBlend(),n&&this.disableDepth(),s&&this.unbindBuffer(),o&&this.unbindTexture2D(),i&&this.unbindRBO(),r&&this.unbindFBO(),e&&this.unbindVAO()}}}get oMouse(){return[this.oMouseX,this.oMouseY]}get mouse(){return[this.mouseX,this.mouseY]}get limit(){return{TOTAL_TEXTURES:this.MAX_TEXTURES,FRAG_TEXTURE:this.MAX_FRAG_TEXTURES,VERT_TEXTURE:this.MAX_VERT_TEXTURES,DRAW_BUFFERS:this.MAX_DRAW_BUFFERS}}get MAX_TEXTURES(){return this.gl.getParameter(this.gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS)}get MAX_FRAG_TEXTURES(){return this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS)}get MAX_VERT_TEXTURES(){return this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS)}get MAX_DRAW_BUFFERS(){return this.gl.getParameter(this.gl.MAX_DRAW_BUFFERS)}get width(){return this.canvas.width}get height(){return this.canvas.height}set width(t){this.canvas2D&&(this.canvas2D.width=t),this.canvas.width=t,this.gl.viewport(0,0,this.canvas.width,this.canvas.height)}set height(t){this.canvas2D&&(this.canvas2D.height=t),this.canvas.height=t,this.gl.viewport(0,0,this.canvas.width,this.canvas.height)}get resolution(){return[this.canvas.width,this.canvas.height]}};n.prototype.BLEND_MODE=32774,n.prototype.BLEND_SFAC=1,n.prototype.BLEND_DFAC=0,n.prototype.STATIC_DRAW=35044,n.prototype.DYNAMIC_DRAW=35048,n.prototype.STREAM_DRAW=35040,n.prototype.STATIC_READ=35045,n.prototype.DYNAMIC_READ=35049,n.prototype.STREAM_READ=35041,n.prototype.STATIC_COPY=35046,n.prototype.DYNAMIC_COPY=35050,n.prototype.STREAM_COPY=35042,n.prototype.COLOR_BUFF=16384,n.prototype.DEPTH_BUFF=256,n.prototype.STENCIL_BUFF=1024,n.prototype.POINTS=0,n.prototype.LINES=1,n.prototype.LINE_LOOP=2,n.prototype.LINE_STRIP=3,n.prototype.TRIANGLES=4,n.prototype.TRIANGLE_STRIP=5,n.prototype.TRIANGLE_FAN=6,n.prototype.REPEAT=10497,n.prototype.CLAMP=33071,n.prototype.MIRROR=33648,n.prototype.NEAREST=9728,n.prototype.LINEAR=9729,n.prototype.NMN=9984,n.prototype.LMN=9985,n.prototype.NML=9986,n.prototype.LML=9987,n.prototype.FB=36160,n.prototype.T2D=3553,n.prototype.RB=36161,n.prototype.DA=36096,n.prototype.AB=34962,n.prototype.ADD=32774,n.prototype.SUB=32778,n.prototype.REV_SUB=32779,n.prototype.MIN=32775,n.prototype.MAX=32776,n.prototype.ZERO=0,n.prototype.ONE=1,n.prototype.SRC_COLOR=768,n.prototype.ONE_MINUS_SRC_COLOR=769,n.prototype.DST_COLOR=774,n.prototype.ONE_MINUS_DST_COLOR=775,n.prototype.SRC_ALPHA=770,n.prototype.ONE_MINUS_SRC_ALPHA=771,n.prototype.DST_ALPHA=772,n.prototype.ONE_MINUS_DST_ALPHA=773,n.prototype.CONSTANT_COLOR=32769,n.prototype.ONE_MINUS_CONSTANT_COLOR=32770,n.prototype.CONSTANT_ALPHA=32771,n.prototype.ONE_MINUS_CONSTANT_ALPHA=32772,n.prototype.SRC_ALPHA_SATURATE=776,n.prototype.RGB=6407,n.prototype.RGBA=6408,n.prototype.LUMINANCE_ALPHA=6410,n.prototype.LUMINANCE=6409,n.prototype.ALPHA=6406,n.prototype.R8=33321,n.prototype.R16F=33325,n.prototype.R32F=33326,n.prototype.R8UI=33330,n.prototype.RG8=33323,n.prototype.RG16F=33327,n.prototype.RG32F=33328,n.prototype.RG8UI=33336,n.prototype.RGB8=32849,n.prototype.SRGB8=35905,n.prototype.RGB565=36194,n.prototype.R11F_G11F_B10F=35898,n.prototype.RGB9_E5=35901,n.prototype.RGB16F=34843,n.prototype.RGB32F=34837,n.prototype.RGB8UI=36221,n.prototype.RGBA8=32856,n.prototype.SRGB8_ALPHA8=35907,n.prototype.RGB5_A1=32855,n.prototype.RGB10_A2=32857,n.prototype.RGBA4=32854,n.prototype.RGBA16F=34842,n.prototype.RGBA32F=34836,n.prototype.RGBA8UI=36220;n.prototype._shader=function(t,e,r){const i=this.gl.createShader(r);/#version 300 es/.test(e)||(e=`#version 300 es\n${e}`),e=e.replace(/^\s+/,""),this.gl.shaderSource(i,e),this.gl.compileShader(i),this.gl.attachShader(t.program,i)},n.prototype._processShader=function(t,e,r){Array.isArray(e)?e.forEach((e=>this._shader(t,e,r))):this._shader(t,e,r)},n.prototype.setShader=function(t,e){this.program=this.createProgram(t,e),this.linkProgram(this.program),this.useProgram(this.program)};n.prototype.setProgram=function(t){this.program=t},n.prototype.linkProgram=function(t){this.setProgram(t),this.gl.linkProgram(t.program)},n.prototype.useProgram=function(t){this.setProgram(t),this.gl.useProgram(t.program)},n.prototype._updateProgramUniforms=function(t,e,r,i){t.uniforms[e]={type:r,size:i}},n.prototype.createProgram=function(e,r,i){const o={program:this.gl.createProgram(),uniforms:{},texUnitList:{},texUnitCount:0,emptyTexUnits:[]};this._processShader(o,e,this.gl.VERTEX_SHADER),this._processShader(o,r,this.gl.FRAGMENT_SHADER),i&&this.gl.transformFeedbackVaryings(o.program,i,this.gl.INTERLEAVED_ATTRIBS),this.linkProgram(o),this.useProgram(o);const s=this._getActiveUniforms(o);for(let e=0;e<s;++e){const{name:r,type:i,size:s}=this._getActiveUniform(o,e);this._updateProgramUniforms(o,r,i,s),t.has(i)&&this._setTexUnit(r)}return o},n.prototype._setTexUnit=function(t){const e=this.program.emptyTexUnits.length?this.program.emptyTexUnits.pop():this.program.texUnitCount++;this.uniform(t,e),this.program.texUnitList[t]=e},n.prototype._getActiveUniform=function(t,e){const r=this.gl.getActiveUniform(t.program,e);return{name:r.name.replace(/\[[^\]]*\]/g,""),type:r.type,size:r.size}};n.prototype.createBuffer=function(t,e){const r=this.gl.createBuffer();return this.useBuffer(r,(()=>this.gl.bufferData(this.AB,t,e))),r},n.prototype.bindBuffer=function(t){this.gl.bindBuffer(this.AB,t)},n.prototype.unbindBuffer=function(){this.gl.bindBuffer(this.AB,null)},n.prototype.useBuffer=function(t,e){this.bindBuffer(t),e(),this.unbindBuffer()};n.prototype.drawArrays=function(t,e,r){this.gl.drawArrays(t,e,r)},n.prototype.points=function(t,e){this.gl.drawArrays(this.gl.POINTS,t,e)},n.prototype.lines=function(t,e){this.gl.drawArrays(this.gl.LINES,t,e)},n.prototype.lineLoop=function(t,e){this.gl.drawArrays(this.gl.LINE_LOOP,t,e)},n.prototype.lineStrip=function(t,e){this.gl.drawArrays(this.gl.LINE_STRIP,t,e)},n.prototype.triangles=function(t,e){this.gl.drawArrays(this.gl.TRIANGLES,t,e)},n.prototype.triangleStrip=function(t,e){this.gl.drawArrays(this.gl.TRIANGLE_STRIP,t,e)},n.prototype.triangleFan=function(t,e){this.gl.drawArrays(this.gl.TRIANGLE_FAN,t,e)},n.prototype.drawArraysInstanced=function(t,e,r,i){this.gl.drawArraysInstanced(t,e,r,i)},n.prototype.pointsInstanced=function(t,e,r){this.gl.drawArraysInstanced(this.gl.POINTS,t,e,r)},n.prototype.linesInstanced=function(t,e,r){this.gl.drawArraysInstanced(this.gl.LINES,t,e,r)},n.prototype.lineLoopInstanced=function(t,e,r){this.gl.drawArraysInstanced(this.gl.LINE_LOOP,t,e,r)},n.prototype.lineStripInstanced=function(t,e,r){this.gl.drawArraysInstanced(this.gl.LINE_STRIP,t,e,r)},n.prototype.trianglesInstanced=function(t,e,r){this.gl.drawArraysInstanced(this.gl.TRIANGLES,t,e,r)},n.prototype.triangleStripInstanced=function(t,e,r){this.gl.drawArraysInstanced(this.gl.TRIANGLE_STRIP,t,e,r)},n.prototype.triangleFanInstanced=function(t,e,r){this.gl.drawArraysInstanced(this.gl.TRIANGLE_FAN,t,e,r)};n.prototype.aLoc=function(t){return this.gl.getAttribLocation(this.program.program,t)},n.prototype.uLoc=function(t){return this.gl.getUniformLocation(this.program.program,t)},n.prototype.oLoc=function(t){return this.gl.getFragDataLocation(this.program.program,t)};n.prototype.setAttribute=function(t,e,r,i,o){const s=this.aLoc(t),n=this.gl.createBuffer(),a=this.UnitMap[r].type;this.useBuffer(n,(()=>{this.gl.bufferData(this.AB,e,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(s,i,a,!1,0,0),this.gl.enableVertexAttribArray(s),Number.isInteger(o)&&o>=0&&this.gl.vertexAttribDivisor(s,o)}));const h={buffer:n,loc:s,name:t,data:e,size:i};return this.bufferList[t]=h,h};n.prototype._getActiveUniforms=function(t){return this.gl.getProgramParameter(t.program,this.gl.ACTIVE_UNIFORMS)},n.prototype.uniform=function(t,e){const r=this.program.uniforms[t];if(!r)return;if(Object.hasOwn(this.program.texUnitList,t))return this.gl.activeTexture(this.gl.TEXTURE0+this.program.texUnitList[t]),void this.gl.bindTexture(this.T2D,e);const i=this.uLoc(t);this.UniformMap[r.type](i,e)},n.prototype.initUniform=function(t){const e={},r=Object.entries(t);for(const[t,i]of r)e[t]=e=>this.uniform(i,t,e);return e};n.prototype._getBorderSize=function(t){const e=window.getComputedStyle(t);return{top:parseFloat(e.borderTopWidth)||0,left:parseFloat(e.borderLeftWidth)||0}},n.prototype._updateMouse=function(t,e,r){this.oMouseX=e/t.scrollWidth,this.oMouseY=r/t.scrollHeight,this.oMouseY=t.height-this.oMouseY,this.mouseX=this.oMouseX/this.width*2-1,this.mouseY=this.oMouseY/this.height*2-1},n.prototype._mouseMove=function(t,e){const r=t.offsetX*e.width,i=t.offsetY*e.height;this._updateMouse(e,r,i)},n.prototype._touchMove=function(t,e){t=t.touches?t.touches[0]:t.changedTouches?.[0];const r=e.getBoundingClientRect(),{left:i,top:o}=this._getBorderSize(e),s=(t.clientX-r.left-i)*e.width,n=(t.clientY-r.top-o)*e.height;this._updateMouse(e,s,n)};n.prototype.enableBlend=function(){this.gl.enable(this.gl.BLEND)},n.prototype.disableBlend=function(){this.gl.disable(this.gl.BLEND)},n.prototype.blend=function({sfactor:t=this.BLEND_SFAC,dfactor:e=this.BLEND_DFAC,mode:r=this.BLEND_MODE}={sfactor:t,dfactor:e,mode:r}){this.BLEND_SFAC=t,this.BLEND_DFAC=e,this.BLEND_MODE=r,this.gl.blendEquation(this.BLEND_MODE),this.gl.blendFunc(this.BLEND_SFAC,this.BLEND_DFAC)};n.prototype.enableDepth=function(){this.gl.enable(this.gl.DEPTH_TEST)},n.prototype.disableDepth=function(){this.gl.disable(this.gl.DEPTH_TEST)},n.prototype.useDepth=function(t){this.gl.enable(this.gl.DEPTH_TEST),t(),this.gl.disable(this.gl.DEPTH_TEST)};n.prototype.clear=function(t){this.gl.clear(t)},n.prototype.clearColor=function(t,e,r,i){0!==arguments.length&&this.gl.clearColor(t,e,r,i),this.gl.clear(this.gl.COLOR_BUFFER_BIT)},n.prototype.clearDepth=function(t){0!==arguments.length&&this.gl.clearDepth(t),this.gl.clear(this.gl.DEPTH_BUFFER_BIT)},n.prototype.clearStencil=function(t){0!==arguments.length&&this.gl.clearStencil(t),this.gl.clear(this.gl.STENCIL_BUFFER_BIT)};n.prototype._isDOMElement=function(t){return t instanceof HTMLElement},n.prototype.setTexParameter=function(t,e,r,i){this.gl.texParameteri(this.T2D,this.gl.TEXTURE_WRAP_S,t),this.gl.texParameteri(this.T2D,this.gl.TEXTURE_WRAP_T,e),this.gl.texParameteri(this.T2D,this.gl.TEXTURE_MIN_FILTER,r),this.gl.texParameteri(this.T2D,this.gl.TEXTURE_MAG_FILTER,i)},n.prototype.bindTexture2D=function(t){this.gl.bindTexture(this.T2D,t)},n.prototype.unbindTexture2D=function(){this.gl.bindTexture(this.T2D,null)},n.prototype.useTexture2D=function(t,e){this.bindTexture2D(t),e(),this.unbindTexture2D()},n.prototype.emptyTexture2D=function(t,e,r,{minFilter:i=this.NML,magFilter:o=this.LINEAR,filter:s,wrapX:n=this.REPEAT,wrapY:a=this.REPEAT,wrap:h,flipY:p=!1}={}){s&&([i,o]=[s,s]),h&&([n,a]=[h,h]);const u=this.gl.createTexture();return this.useTexture2D(u,(()=>{this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,p),this.setTexParameter(n,a,i,o),this.gl.texStorage2D(this.T2D,1,r,t,e)})),u},n.prototype.texture2D=function({data:t=null,iformat:e,level:r=0,width:i,height:o,minFilter:s=this.NML,magFilter:n=this.LINEAR,filter:a,wrapX:h=this.REPEAT,wrapY:p=this.REPEAT,wrap:u,flipY:l=this._isDOMElement(t)}={data:t,iformat:e,level:r,width:i,height:o,minFilter:s,magFilter:n,filter:a,wrapX:h,wrapY:p,wrap:u,flipY:l}){if(i||(i=t?.width),o||(o=t?.height),!i)throw"Please specify width.";if(!o)throw"Please specify height.";if(a&&([s,n]=[a,a]),u&&([h,p]=[u,u]),!t)return this.emptyTexture2D(i,o,{minFilter:s,magFilter:n,wrapX:h,wrapY:p});const{format:c,type:f}=this.IFormatMap[e],g=this.gl.createTexture();return this.gl.bindTexture(this.T2D,g),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,l),this.gl.texImage2D(this.T2D,r,e,i,o,0,c,f,t),this.gl.generateMipmap(this.T2D),this.setTexParameter(h,p,s,n),this.gl.bindTexture(this.T2D,null),g};n.prototype._calcStride=function(t){return t.reduce(((t,{unit:e,size:r})=>t+r*this.UnitMap[e].size),0)},n.prototype._vaoByBufferInfos=function(t,e){Array.isArray(e)||(e=[e]);const r=this.gl.createVertexArray();return this.use({program:this.useProgram(t),VAO:r}).run((()=>{e.forEach((t=>{this.useBuffer(t.buffer,(()=>{const e=t.attributes,r=t.stride||this._calcStride(e),i=t.divisor;let o=0;e.forEach((({name:t,unit:e,size:s})=>{const n=this.aLoc(t),a=this.UnitMap[e].type;this.gl.vertexAttribPointer(n,s,a,!1,r,o),this.gl.enableVertexAttribArray(n),o+=s*this.UnitMap[e].size,Number.isInteger(i)&&i>=0&&this.gl.vertexAttribDivisor(n,i)}))}))}))})),r},n.prototype._vaoByAttribute=function(t,e){this.useProgram(t);const i=this.gl.createVertexArray();return this.useVAO(i,(()=>{e.forEach((({name:t,data:e,size:i})=>{const o=r[e.constructor.name];this.setAttribute(t,e,o,i)}))})),i},n.prototype._checkUseAttribute=function(t){return Array.isArray(t)&&Object.hasOwn(t[0],"name")},n.prototype.createVAO=function(t,e){return this._checkUseAttribute(e)?this._vaoByAttribute(t,e):this._vaoByBufferInfos(t,e)},n.prototype.bindVAO=function(t){this.gl.bindVertexArray(t)},n.prototype.unbindVAO=function(){this.gl.bindVertexArray(null)},n.prototype.useVAO=function(t,e){this.bindVAO(t),e(),this.unbindVAO()};n.prototype.bindFBO=function(t){this.gl.bindFramebuffer(this.FB,t)},n.prototype.unbindFBO=function(){this.gl.bindFramebuffer(this.FB,null)},n.prototype.useFBO=function(t,e){this.bindFBO(t),e(),this.unbindFBO()},n.prototype.checkFramebufferStatus=function(){switch(this.gl.checkFramebufferStatus(this.FB)){case this.gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw"FRAMEBUFFER INCOMPLETE: FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case this.gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw"FRAMEBUFFER INCOMPLETE: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case this.gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw"FRAMEBUFFER INCOMPLETE: FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case this.gl.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:throw"FRAMEBUFFER INCOMPLETE: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE";case this.gl.FRAMEBUFFER_UNSUPPORTED:throw"FRAMEBUFFER INCOMPLETE: FRAMEBUFFER_UNSUPPORTED"}},n.prototype.createFBO=function({program:t,outs:e,depthBuffer:r}){const i=this.gl.createFramebuffer();return this.useFBO(i,(()=>{const i=this.gl.getParameter(this.gl.MAX_DRAW_BUFFERS),o=Array.from({length:i},(()=>this.gl.NONE));this.setProgram(t),e.forEach((({name:t,texture:e})=>{const r=this.oLoc(t),i=this.gl.COLOR_ATTACHMENT0+r;o[r]=i,this.gl.framebufferTexture2D(this.FB,i,this.T2D,e,0)})),this.gl.framebufferRenderbuffer(this.FB,this.DA,this.RB,r),this.gl.drawBuffers(o),this.checkFramebufferStatus()})),i};n.prototype.bindRBO=function(t){this.gl.bindRenderbuffer(this.RB,t)},n.prototype.unbindRBO=function(){this.gl.bindRenderbuffer(this.RB,null)},n.prototype.useRBO=function(t,e){this.bindRBO(t),e(),this.unbindRBO()};n.prototype.createDepthBuffer=function(t,e,r=16){const i=this.gl.createRenderbuffer();return this.useRBO(i,(()=>this.gl.renderbufferStorage(this.RB,24===r?this.gl.DEPTH_COMPONENT24:32===r?this.gl.DEPTH_COMPONENT32F:this.gl.DEPTH_COMPONENT16,t,e))),i};n.prototype.transformFeedback=function(t,e,r,i){this.useVAO(t,(()=>{this.gl.bindBufferBase(this.gl.TRANSFORM_FEEDBACK_BUFFER,0,e),this.gl.enable(this.gl.RASTERIZER_DISCARD),this.gl.beginTransformFeedback(r),i(),this.gl.endTransformFeedback(),this.gl.disable(this.gl.RASTERIZER_DISCARD),this.gl.bindBufferBase(this.gl.TRANSFORM_FEEDBACK_BUFFER,0,null)}))};const a=t=>new Promise(((e,r)=>{const i=new Image;i.addEventListener("load",(()=>e(i))),i.addEventListener("error",(e=>{r(new Error(`Error loading image from ${t}: ${e.message}`))})),i.crossOrigin="anonymous",i.src=t})),h=async t=>{let e;try{const r=await fetch(t);if(!r.ok)throw new Error(`Failed to fetch ${t}`);return e=await r.text(),e=await p(e),e}catch(t){throw console.error(t),t}},p=async t=>{const e=/#include "(.+)"/g,r=[];let i;for(;null!==(i=e.exec(t));)r.push(i[1]);const o=await Promise.all(r.map((async t=>{try{const e=await fetch(t);if(!e.ok)throw new Error(`Failed to fetch ${t}`);return await e.text()}catch(e){throw console.error(`Failed to load included file: ${t}`),e}})));return r.forEach(((e,r)=>{t=t.replace(`#include "${e}"`,o[r])})),t};var u=(t,e)=>new n(t,e);export{u as default,h as loadShader,a as loadImage,s as Data};